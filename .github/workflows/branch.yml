on:
  push:
    branches:
      - 'feature/**'
  workflow_dispatch:
  # schedule:
  #   - cron:  '30 5 * * *'
name: 'Feature (CI-Test) Build'

jobs:
  server:
    name: (CI-Test Only) Deploy App - Backend
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [14.x]
    environment: production
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-1
      - name: Get Build Tag
        id: tag
        run: echo "::set-output name=date::$(date +'%Y%m%d')"
    #   - name: cdk deploy
    #     uses: youyo/aws-cdk-github-actions@v2
    #     with:
    #       cdk_subcommand: 'deploy'
    #       cdk_stack: 'prod-us1'
    #       cdk_args: '--require-approval never'
    #       actions_comment: false
    #     env:
    #       AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
    #       AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    #       AWS_DEFAULT_REGION: 'us-east-1'
